/**
 * 贵州都市网自适应超级滚动滚动jQuery插件 gzdswSuperScroll
 * 最后更新时间： 2013-08-30
 * 组件免费使用，转载请保留注释，谢谢
 * @author wujinhai (940390@qq.com)
 */
(function($){$.fn.gzdswSuperScroll=function(options){var opts=$.extend({},$.fn.gzdswSuperScroll.defaults,options);return this.each(function(){if($(this).attr("inited")=="true"){return true}var _box=$(this);var _moveBox=_box.find("ul");var _type=(opts.direction=="left"||opts.direction=="right")?1:0;var _moveType=(opts.direction=="left"||opts.direction=="up")?1:-1;var _lis=_moveBox.children();var _li=_lis.first();var _len=_lis.size();var _curStep=_moveType==1?0:_len;var _timeoutHandle=null;var _intervalHandle=null;var _scrollMax=0;var _scrollInit=0;var _param=[];var _dir=_type==1?"scrollLeft":"scrollTop";var _offsetDir=_type==1?"offsetLeft":"offsetTop";var _stop=false;var _oldStep=opts.step;var _goleft=(typeof opts.goleft!="")?(opts.goleft.substr(0,8)=="children"?(_box.parent().find(opts.goleft.replace("children ",""))):$(opts.goleft)):null;var _goright=(typeof opts.goright!="")?(opts.goright.substr(0,8)=="children"?(_box.parent().find(opts.goright.replace("children ",""))):$(opts.goright)):null;if(typeof _li=="undefined"){return true}if(_len==1){return true}_box.css({position:"relative",overflow:"hidden"});if(opts.width){_box.width(opts.width)}if(opts.height){_box.height(opts.height)}_lis.each(function(){_scrollMax+=(opts.direction=="left"||opts.direction=="right")?$(this).get(0)["scrollWidth"]:$(this).get(0)["scrollHeight"]});_moveBox.append(_lis.clone());var _clonelis=_moveBox.children();if((_type==1?_box.width():_box.height())>_scrollMax){return true}if(opts.direction=="left"||opts.direction=="right"){_moveBox.css({width:_scrollMax*2,overflow:"hidden",display:"block"})}else{_moveBox.css({height:_scrollMax*2,overflow:"hidden",display:"block"})}if(opts.distance>0){opts.step=opts.step>_scrollMax?_scrollMax:opts.step}else{opts.step=opts.step>_len?_len:opts.step}_scrollInit=_moveType==1?0:_clonelis.eq(_len).get(0)[_offsetDir];_box.get(0)[_dir]=_scrollInit;if(opts.distance||opts.ismarquee){_curStep=_moveType==1?0:_scrollInit}if(opts.autostart){setTimeout(Start,opts.timeout);bindMouseevent()}_box.attr("inited","true");if(_goleft!=null){if(opts.ismarquee){_goleft.hover(function(){opts.autostart=true;bindMouseevent();_moveType=1;opts.step=_oldStep+opts.distance;_scrollInit=_moveType==1?0:_clonelis.eq(_len).get(0)[_offsetDir];clearTimeout(_timeoutHandle);clearInterval(_intervalHandle);Start()},function(){opts.step=_oldStep})}else{_goleft.bind(opts.goevent,function(){opts.autostart=true;bindMouseevent();_moveType=1;_scrollInit=_moveType==1?0:_clonelis.eq(_len).get(0)[_offsetDir];clearTimeout(_timeoutHandle);clearInterval(_intervalHandle);scrollFun()})}}if(_goright!=null){if(opts.ismarquee){_goright.hover(function(){opts.autostart=true;bindMouseevent();_moveType=-1;opts.step=_oldStep+opts.distance;_scrollInit=_moveType==1?0:_clonelis.eq(_len).get(0)[_offsetDir];clearTimeout(_timeoutHandle);clearInterval(_intervalHandle);Start()},function(){opts.step=_oldStep})}else{_goright.bind(opts.goevent,function(){opts.autostart=true;bindMouseevent();_moveType=-1;_scrollInit=_moveType==1?0:_clonelis.eq(_len).get(0)[_offsetDir];clearTimeout(_timeoutHandle);clearInterval(_intervalHandle);scrollFun()})}}function bindMouseevent(){_moveBox.mouseover(function(){_stop=true;clearTimeout(_timeoutHandle);clearInterval(_intervalHandle)});_moveBox.mouseout(function(){_stop=false;opts.step=_oldStep;Start()})}function Start(){if(_stop){return}clearTimeout(_timeoutHandle);clearInterval(_intervalHandle);if(opts.ismarquee){_intervalHandle=setInterval(marqueeFun,opts.interval)}else{if(opts.distance){_timeoutHandle=setTimeout(distanceFun,opts.interval)}else{_timeoutHandle=setTimeout(scrollFun,opts.interval)}}}function marqueeFun(){if(_stop){return}var posmax=_clonelis.eq(_moveType?_len:0).get(0)[_offsetDir];_curStep+=_moveType*opts.step;if(_curStep<0){_curStep=0}if(_curStep>posmax){_curStep=posmax}if(((_moveType==1)&&(_box.get(0)[_dir]>=posmax))||((_moveType==-1)&&(_box.get(0)[_dir]<=0))){_curStep=_moveType==1?_moveType*opts.step:(posmax-opts.step);_box.get(0)[_dir]=_moveType==1?0:(posmax)}_box.get(0)[_dir]=_curStep}function distanceFun(){if(_stop){return}var posmax=_clonelis.eq(_moveType?_len:0).get(0)[_offsetDir];_curStep+=_moveType*opts.distance;if(_curStep<0){_curStep=0}if(_curStep>posmax){_curStep=posmax}if(((_moveType==1)&&(_box.get(0)[_dir]>=posmax))||((_moveType==-1)&&(_box.get(0)[_dir]<=0))){_curStep=_moveType==1?_moveType*opts.distance:(posmax-opts.distance);_box.get(0)[_dir]=_moveType==1?0:(posmax)}_param[_dir]=_curStep;_box.animate(_param,opts.speed,opts.easing,function(){Start()})}function scrollFun(){if(_stop){return}if(((_moveType==1)&&(_box.get(0)[_dir]>=_clonelis.eq(_len).get(0)[_offsetDir]))||((_moveType==-1)&&(_box.get(0)[_dir]<=_clonelis.eq(0).get(0)[_offsetDir]))){_box.get(0)[_dir]=_scrollInit;_curStep=_moveType==1?opts.step:(_len-opts.step)}else{_curStep+=_moveType*opts.step;if(_curStep<0){_curStep=0}if(_curStep>_len){_curStep=_len}}_param[_dir]=_clonelis.eq(_curStep).get(0)[_offsetDir];_box.animate(_param,opts.speed,opts.easing,function(){Start()
})}})};$.fn.gzdswSuperScroll.defaults={timeout:3000,interval:3000,autostart:true,step:1,direction:"left",distance:0,ismarquee:false,width:0,height:0,goevent:"click",goleft:"",goright:"",speed:"normal",easing:""};$.fn.gzdswSuperScroll.setDefaults=function(settings){$.extend($.fn.gzdswSuperScroll.defaults,settings)}})(jQuery);